<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙˆØ³ÙŠÙ„ Ù„Ø§ÙŠÙ Ø¨Ø±Ùˆ - Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<!-- Ø®Ø·ÙˆØ· -->
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">

<style>
:root {
    --primary-bg: linear-gradient(135deg, #0a0c1a 0%, #151a35 50%, #0a0c1a 100%);
    --card-bg: linear-gradient(145deg, rgba(21, 24, 37, 0.9), rgba(30, 33, 58, 0.9));
    --header-bg: linear-gradient(90deg, #090b16 0%, #11162b 50%, #090b16 100%);
    --accent-color: #5d72d6;
    --accent-hover: #6f83e8;
    --accent-glow: rgba(93, 114, 214, 0.4);
    --text-color: #ffffff;
    --text-secondary: #a8b1e1;
    --border-radius: 20px;
    --box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
    --box-shadow-light: 0 8px 25px rgba(0, 0, 0, 0.3);
    --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: var(--primary-bg); font-family: "Tajawal", sans-serif; color: var(--text-color); overflow-x: hidden; }

.background-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -9; overflow: hidden; }
.bg-circle { position: absolute; border-radius: 50%; opacity: 0.15; filter: blur(60px); animation: float 20s infinite linear; }
.circle-1 { width: 500px; height: 500px; background: var(--accent-color); top: -200px; left: -200px; animation-delay: 0s; }
.circle-2 { width: 400px; height: 400px; background: #ff6b6b; bottom: -150px; right: -150px; animation-delay: -5s; animation-duration: 25s; }
.circle-3 { width: 300px; height: 300px; background: #4ecdc4; top: 50%; left: 80%; animation-delay: -10s; animation-duration: 30s; }
@keyframes float { 0% { transform: translate(0,0) rotate(0deg); } 33% { transform: translate(30px,-30px) rotate(120deg); } 66% { transform: translate(-20px,20px) rotate(240deg); } 100% { transform: translate(0,0) rotate(360deg); } }

.main-header { width: 100%; padding: 15px 0; background: var(--header-bg); border-bottom: 2px solid rgba(255,255,255,0.1); backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 999; }
.header-content {
    max-width: 1600px;
    margin: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    gap: 20px;
}

.logo-section { flex-shrink: 0; }
.app-logo { width: 40px; height: 40px; border-radius: 12px; }

.app-name { display: flex; flex-direction: column; justify-content: center; text-align: left; }
.app-title {
    font-size: 18px;
    font-weight: 900;
    background: linear-gradient(135deg, var(--accent-color), #ffd700);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
.app-subtitle { font-size: 10px; color: var(--text-secondary); }

.date-section { background: rgba(255,255,255,0.05); padding: 8px 12px; border-radius: 15px; border: 1px solid var(--accent-glow); box-shadow: 0 0 15px rgba(255,255,255,0.1); }
.hijri-date { font-size: 13px; color: var(--text-secondary); }
.gregorian-date { font-size: 15px; font-weight: bold; }

#matches-container { padding: 20px; max-width: 1200px; margin: 20px auto; display: grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap: 20px; }

.match-box {
    background: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 15px;
    box-shadow: var(--box-shadow);
    transition: transform 0.5s, box-shadow 0.5s;
    transform-style: preserve-3d;
    cursor: pointer;
}
.match-box:hover {
    transform: rotateY(10deg) rotateX(5deg) translateY(-10px) scale(1.05);
    box-shadow: 0 30px 50px rgba(0,0,0,0.7);
}
.match-info { display: flex; justify-content: space-between; align-items: center; }
.match-info img { width: 50px; height: 50px; border-radius: 12px; }
.match-details { display: flex; justify-content: space-around; padding: 10px 0 5px; margin-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); font-size:14px; color:var(--text-secondary); }
.match-actions { display: flex; gap: 10px; justify-content: center; margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); flex-wrap: wrap; }

.btn { padding: 8px 15px; border-radius: 15px; cursor: pointer; margin: 5px; border: none; font-size: 14px; }
.btn-success { background:#28a745; color:white; font-weight:bold; }
.btn-info { background:#17a2b8; color:white; }
.btn-warning { background:#ffc107; color:#000; font-weight:bold; }
.btn-secondary { background:#555; color:white; }

.download-section { background: var(--card-bg); border-radius: 22px; margin: 30px auto; max-width: 600px; padding: 20px; box-shadow: var(--box-shadow); text-align:center; }

.loading { text-align:center; padding:40px; color:var(--text-secondary); font-size:18px; }
.error { background: linear-gradient(135deg, #e74c3c, #c0392b); color:white; padding:20px; border-radius:15px; margin:20px 0; box-shadow: 0 8px 25px rgba(0,0,0,0.3); font-weight:500; }
.success { background: linear-gradient(135deg, #2ecc71, #27ae60); color:white; padding:20px; border-radius:15px; margin:20px 0; box-shadow: 0 8px 25px rgba(0,0,0,0.3); }

.fade-in { animation: fadeInUp 0.6s ease-out; }
@keyframes fadeInUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }

/* Ø£Ù†Ù…Ø§Ø· Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ø§ØªØµØ§Ù„ */
.connection-error {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: white;
    padding: 20px;
    border-radius: 15px;
    margin: 20px 0;
    text-align: center;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.connection-warning {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
    padding: 15px;
    border-radius: 10px;
    margin: 15px 0;
    text-align: center;
}

.connection-success {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    padding: 20px;
    border-radius: 15px;
    margin: 20px 0;
    text-align: center;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.btn-retry {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
    margin-top: 10px;
    font-weight: bold;
    transition: all 0.3s ease;
}

.btn-retry:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

</style>
</head>
<body>

<div class="background-animation">
    <div class="bg-circle circle-1"></div>
    <div class="bg-circle circle-2"></div>
    <div class="bg-circle circle-3"></div>
</div>

<header class="main-header">
    <div class="header-content">
        <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
        <div class="logo-section">
            <img src="https://i.postimg.cc/Bb0WFJfJ/Picsart-25-01-18-03-49-12-620.png" alt="Logo" class="app-logo">
        </div>
        <!-- Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
        <div class="app-name">
            <span class="app-title">ÙˆØ³ÙŠÙ„ Ù„Ø§ÙŠÙ Ø¨Ø±Ùˆ</span>
            <span class="app-subtitle">Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</span>
        </div>
        <!-- Ø§Ù„ØªØ§Ø±ÙŠØ® -->
        <div class="date-section">
            <div class="hijri-date" id="hijri-date">Ø¬Ø¯ÙˆÙ„ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</div>
            <div class="gregorian-date" id="greg-date">--</div>
        </div>
    </div>
</header>

<div id="matches-container">
    <div class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª...</div>
</div>

<script>
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
const firebaseConfig = {
    apiKey: "AIzaSyCqE7ZwveHg1dIhYf1Hlo7OpHyCZudeZvM",
    authDomain: "wacel-live.firebaseapp.com",
    databaseURL: "https://wacel-live-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "wacel-live",
    storageBucket: "wacel-live.firebasestorage.app",
    messagingSenderId: "185108554006",
    appId: "1:185108554006:web:93171895b1d4bb07c6f037"
};

let firebaseApp, firebaseDb;
try {
    firebaseApp = firebase.initializeApp(firebaseConfig);
    firebaseDb = firebase.database();
} catch (e) {
    console.error("Firebase Error:", e);
    document.getElementById('matches-container').innerHTML = '<div class="error">âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>';
}

// Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
async function checkInternetConnection() {
    return new Promise((resolve, reject) => {
        if (!navigator.onLine) {
            reject(new Error("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"));
            return;
        }

        const img = new Image();
        img.src = "https://www.google.com/images/phd/px.gif?t=" + new Date().getTime();
        let timer = setTimeout(() => {
            reject(new Error("Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"));
        }, 5000);

        img.onload = () => {
            clearTimeout(timer);
            resolve(true);
        };

        img.onerror = () => {
            clearTimeout(timer);
            reject(new Error("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"));
        };
    });
}

// Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„
async function loadMatchesWithConnectionCheck() {
    const container = document.getElementById('matches-container');
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„
    container.innerHTML = `
        <div class="loading">
            <div class="spinner-border text-primary mb-3" role="status">
                <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</span>
            </div>
            <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª...</p>
        </div>
    `;
    
    try {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø£ÙˆÙ„Ø§Ù‹
        await checkInternetConnection();
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø§ØªØµØ§Ù„ØŒ Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
        if (!firebaseDb) {
            container.innerHTML = '<div class="error">âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>';
            return;
        }
        
        firebaseDb.ref('matches').on('value', snapshot => {
            displayMatches(snapshot);
        }, error => {
            console.error(error);
            container.innerHTML = '<div class="error">âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</div>';
        });
        
    } catch (error) {
        console.error('Connection error:', error);
        container.innerHTML = `
            <div class="connection-error">
                <i class="fa fa-wifi-slash mb-2" style="font-size: 2rem;"></i>
                <h4>âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</h4>
                <p>${error.message || "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"}</p>
                <p>Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>
                <button onclick="loadMatchesWithConnectionCheck()" class="btn-retry">
                    <i class="fa fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                </button>
            </div>
        `;
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const today = new Date();
    document.getElementById('greg-date').textContent = today.toLocaleDateString('ar-AR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    loadMatchesWithConnectionCheck();
});

function openXpolaApp(link) { if (link) window.location.href = link; }

function displayMatches(snapshot) {
    const container = document.getElementById('matches-container');
    container.innerHTML = '';
    if (!snapshot.exists()) { container.innerHTML = '<div class="loading">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</div>'; return; }

    const matches = snapshot.val();
    for (const key in matches) {
        const match = matches[key];
        const matchDiv = document.createElement('div');
        matchDiv.className = 'match-box fade-in';
        matchDiv.innerHTML = `
            <div class="match-info">
                <div><img src="${match.team1Logo||'#'}"><p>${match.team1||'ÙØ±ÙŠÙ‚ 1'}</p></div>
                <div><span class="match-time">${match.time||'00:00'}</span></div>
                <div><img src="${match.team2Logo||'#'}"><p>${match.team2||'ÙØ±ÙŠÙ‚ 2'}</p></div>
            </div>
            <div class="match-details">
                <div>${match.channel||'Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'}</div>
                <div>${match.commentator||'Ù…Ø¹Ù„Ù‚ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
            </div>
            <div class="match-actions">
                <button class="btn btn-success" onclick="openXpolaApp('${match.xmtvLink||'#'}')">ğŸ“± Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</button>
                <button class="btn btn-info" onclick="window.open('https://play.google.com/store/apps/details?id=com.xpola.player','_blank')">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ù…Ø´ØºÙ„ Ø§Ù„Ù‚Ù†Ø§Ø©</button>
            </div>
        `;
        container.appendChild(matchDiv);
    }
}
</script>

</body>
</html>
